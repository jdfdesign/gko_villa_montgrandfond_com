!function(t,e){var i=function(){var e=t(document).data("events");return e&&e.click&&t.grep(e.click,function(t){return"rails"===t.namespace}).length};i()&&t.error("jquery-ujs has already been loaded!");var a;t.rails=a={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(e){var i=t('meta[name="csrf-token"]').attr("content");i&&e.setRequestHeader("X-CSRF-Token",i)},fire:function(e,i,a){var n=t.Event(i);return e.trigger(n,a),n.result!==!1},confirm:function(t){return confirm(t)},ajax:function(e){return t.ajax(e)},href:function(t){return t.attr("href")},handleRemote:function(i){var n,o,r,s,l,c,h,u;if(a.fire(i,"ajax:before")){if(s=i.data("cross-domain"),l=s===e?null:s,c=i.data("with-credentials")||null,h=i.data("type")||t.ajaxSettings&&t.ajaxSettings.dataType,i.is("form")){n=i.attr("method"),o=i.attr("action"),r=i.serializeArray();var d=i.data("ujs:submit-button");d&&(r.push(d),i.data("ujs:submit-button",null))}else i.is(a.inputChangeSelector)?(n=i.data("method"),o=i.data("url"),r=i.serialize(),i.data("params")&&(r=r+"&"+i.data("params"))):(n=i.data("method"),o=a.href(i),r=i.data("params")||null);u={type:n||"GET",data:r,dataType:h,beforeSend:function(t,n){return n.dataType===e&&t.setRequestHeader("accept","*/*;q=0.5, "+n.accepts.script),a.fire(i,"ajax:beforeSend",[t,n])},success:function(t,e,a){i.trigger("ajax:success",[t,e,a])},complete:function(t,e){i.trigger("ajax:complete",[t,e])},error:function(t,e,a){i.trigger("ajax:error",[t,e,a])},xhrFields:{withCredentials:c},crossDomain:l},o&&(u.url=o);var p=a.ajax(u);return i.trigger("ajax:send",p),p}return!1},handleMethod:function(i){var n=a.href(i),o=i.data("method"),r=i.attr("target"),s=t("meta[name=csrf-token]").attr("content"),l=t("meta[name=csrf-param]").attr("content"),c=t('<form method="post" action="'+n+'"></form>'),h='<input name="_method" value="'+o+'" type="hidden" />';l!==e&&s!==e&&(h+='<input name="'+l+'" value="'+s+'" type="hidden" />'),r&&c.attr("target",r),c.hide().append(h).appendTo("body"),c.submit()},disableFormElements:function(e){e.find(a.disableSelector).each(function(){var e=t(this),i=e.is("button")?"html":"val";e.data("ujs:enable-with",e[i]()),e[i](e.data("disable-with")),e.prop("disabled",!0)})},enableFormElements:function(e){e.find(a.enableSelector).each(function(){var e=t(this),i=e.is("button")?"html":"val";e.data("ujs:enable-with")&&e[i](e.data("ujs:enable-with")),e.prop("disabled",!1)})},allowAction:function(t){var e,i=t.data("confirm"),n=!1;return i?(a.fire(t,"confirm")&&(n=a.confirm(i),e=a.fire(t,"confirm:complete",[n])),n&&e):!0},blankInputs:function(e,i,a){var n,o,r=t(),s=i||"input,textarea";return e.find(s).each(function(){n=t(this),o=n.is(":checkbox,:radio")?n.is(":checked"):n.val(),o==!!a&&(r=r.add(n))}),r.length?r:!1},nonBlankInputs:function(t,e){return a.blankInputs(t,e,!0)},stopEverything:function(e){return t(e.target).trigger("ujs:everythingStopped"),e.stopImmediatePropagation(),!1},callFormSubmitBindings:function(i,a){var n=i.data("events"),o=!0;return n!==e&&n.submit!==e&&t.each(n.submit,function(t,e){return"function"==typeof e.handler?o=e.handler(a):void 0}),o},disableElement:function(t){t.data("ujs:enable-with",t.html()),t.html(t.data("disable-with")),t.bind("click.railsDisable",function(t){return a.stopEverything(t)})},enableElement:function(t){t.data("ujs:enable-with")!==e&&(t.html(t.data("ujs:enable-with")),t.data("ujs:enable-with",!1)),t.unbind("click.railsDisable")}},a.fire(t(document),"rails:attachBindings")&&(t.ajaxPrefilter(function(t,e,i){t.crossDomain||a.CSRFProtection(i)}),t(document).delegate(a.linkDisableSelector,"ajax:complete",function(){a.enableElement(t(this))}),t(document).delegate(a.linkClickSelector,"click.rails",function(i){var n=t(this),o=n.data("method"),r=n.data("params");return a.allowAction(n)?(n.is(a.linkDisableSelector)&&a.disableElement(n),n.data("remote")!==e?!i.metaKey&&!i.ctrlKey||o&&"GET"!==o||r?(a.handleRemote(n)===!1&&a.enableElement(n),!1):!0:n.data("method")?(a.handleMethod(n),!1):void 0):a.stopEverything(i)}),t(document).delegate(a.inputChangeSelector,"change.rails",function(e){var i=t(this);return a.allowAction(i)?(a.handleRemote(i),!1):a.stopEverything(e)}),t(document).delegate(a.formSubmitSelector,"submit.rails",function(i){var n=t(this),o=n.data("remote")!==e,r=a.blankInputs(n,a.requiredInputSelector),s=a.nonBlankInputs(n,a.fileInputSelector);return a.allowAction(n)?r&&n.attr("novalidate")==e&&a.fire(n,"ajax:aborted:required",[r])?a.stopEverything(i):o?s?(setTimeout(function(){a.disableFormElements(n)},13),a.fire(n,"ajax:aborted:file",[s])):!t.support.submitBubbles&&t().jquery<"1.7"&&a.callFormSubmitBindings(n,i)===!1?a.stopEverything(i):(a.handleRemote(n),!1):(setTimeout(function(){a.disableFormElements(n)},13),void 0):a.stopEverything(i)}),t(document).delegate(a.formInputClickSelector,"click.rails",function(e){var i=t(this);if(!a.allowAction(i))return a.stopEverything(e);var n=i.attr("name"),o=n?{name:n,value:i.val()}:null;i.closest("form").data("ujs:submit-button",o)}),t(document).delegate(a.formSubmitSelector,"ajax:beforeSend.rails",function(e){this==e.target&&a.disableFormElements(t(this))}),t(document).delegate(a.formSubmitSelector,"ajax:complete.rails",function(e){this==e.target&&a.enableFormElements(t(this))}),t(function(){csrf_token=t("meta[name=csrf-token]").attr("content"),csrf_param=t("meta[name=csrf-param]").attr("content"),t('form input[name="'+csrf_param+'"]').val(csrf_token)}))}(jQuery),function(t){var e,i=this,a=i.document,n=t(a),o=t(i),r=Array.prototype,s=1.28,l=!0,c=3e4,h=!1,u=navigator.userAgent.toLowerCase(),d=i.location.hash.replace(/#\//,""),p=function(){},g=function(){return!1},m=function(){var t=3,i=a.createElement("div"),n=i.getElementsByTagName("i");do i.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->";while(n[0]);return t>4?t:e}(),f=function(){return{html:a.documentElement,body:a.body,head:a.getElementsByTagName("head")[0],title:a.title}},b="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",v=function(){var e=[];return t.each(b.split(" "),function(t,i){e.push(i),/_/.test(i)&&e.push(i.replace(/_/g,""))}),e}(),y=function(e){var i;return"object"!=typeof e?e:(t.each(e,function(a,n){/^[a-z]+_/.test(a)&&(i="",t.each(a.split("_"),function(t,e){i+=t>0?e.substr(0,1).toUpperCase()+e.substr(1):e}),e[i]=n,delete e[a])}),e)},_=function(e){return t.inArray(e,v)>-1?Galleria[e.toUpperCase()]:e},w={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(t){return"http://www.youtube.com/embed/"+t},getThumb:function(e,i,a){a=a||p,t.getJSON("http://gdata.youtube.com/feeds/api/videos/"+e+"?v=2&alt=json-in-script&callback=?",function(t){try{i(t.entry.media$group.media$thumbnail[0].url)}catch(e){a()}}).error(a)}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(t){return"http://player.vimeo.com/video/"+t},getThumb:function(e,i,a){a=a||p,t.getJSON("http://vimeo.com/api/v2/video/"+e+".json?callback=?",function(t){try{i(t[0].thumbnail_medium)}catch(e){a()}}).error(a)}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(t){return"http://www.dailymotion.com/embed/video/"+t},getThumb:function(e,i,a){a=a||p,t.getJSON("https://api.dailymotion.com/video/"+e+"?fields=thumbnail_medium_url&callback=?",function(t){try{i(t.thumbnail_medium_url)}catch(e){a()}}).error(a)}}},x=function(t){var e;for(var i in w)if(e=t&&t.match(w[i].reg),e&&e.length)return{id:e[2],provider:i};return!1},T={support:function(){var t=f().html;return t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen}(),callback:p,enter:function(t,e){this.instance=t,this.callback=e||p;var i=f().html;i.requestFullscreen?i.requestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullScreen&&i.webkitRequestFullScreen()},exit:function(t){this.callback=t||p,a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen()},instance:null,listen:function(){if(this.support){var t=function(){if(T.instance){var t=T.instance._fullscreen;a.fullscreen||a.mozFullScreen||a.webkitIsFullScreen?t._enter(T.callback):t._exit(T.callback)}};a.addEventListener("fullscreenchange",t,!1),a.addEventListener("mozfullscreenchange",t,!1),a.addEventListener("webkitfullscreenchange",t,!1)}}},k={trunk:{},add:function(t,e,a,n){if(t=t||(new Date).getTime(),n=n||!1,this.clear(t),n){var o=e;e=function(){o(),k.add(t,e,a)}}this.trunk[t]=i.setTimeout(e,a)},clear:function(t){var e,a=function(t){i.clearTimeout(this.trunk[t]),delete this.trunk[t]};if(t&&t in this.trunk)a.call(k,t);else if("undefined"==typeof t)for(e in this.trunk)this.trunk.hasOwnProperty(e)&&a.call(k,e)}},S=[],G=[],C=!1,I=!1,E=[],A=function(e){Galleria.theme=e,t.each(E,function(t,e){e._initialized||e._init.call(e)})},$=function(){return{array:function(t){return r.slice.call(t,0)},create:function(t,e){e=e||"div";var i=a.createElement(e);return i.className=t,i},getScriptPath:function(e){e=e||t("script:last").attr("src");var i=e.split("/");return 1==i.length?"":(i.pop(),i.join("/")+"/")},animate:function(){var e,n,o,r,s,l,c,h=function(t){var e,a="transition WebkitTransition MozTransition OTransition".split(" ");if(i.opera)return!1;for(e=0;a[e];e++)if("undefined"!=typeof t[a[e]])return a[e];return!1}((a.body||a.documentElement).style),u={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[h],d={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},g=function(e,i,a){var n={};a=a||"transition",t.each("webkit moz ms o".split(" "),function(){n["-"+this+"-"+a]=i}),e.css(n)},m=function(t){g(t,"none","transition"),Galleria.WEBKIT&&Galleria.TOUCH&&(g(t,"translate3d(0,0,0)","transform"),t.data("revert")&&(t.css(t.data("revert")),t.data("revert",null)))};return function(a,f,b){return b=t.extend({duration:400,complete:p,stop:!1},b),a=t(a),b.duration?h?(b.stop&&(a.unbind(u),m(a)),e=!1,t.each(f,function(t,i){c=a.css(t),$.parseValue(c)!=$.parseValue(i)&&(e=!0),a.css(t,c)}),e?(n=[],o=b.easing in d?d[b.easing]:d._default,r=" "+b.duration+"ms cubic-bezier("+o.join(",")+")",i.setTimeout(function(e,i,a,o){return function(){e.one(i,function(t){return function(){m(t),b.complete.call(t[0])}}(e)),Galleria.WEBKIT&&Galleria.TOUCH&&(s={},l=[0,0,0],t.each(["left","top"],function(t,i){i in a&&(l[t]=$.parseValue(a[i])-$.parseValue(e.css(i))+"px",s[i]=a[i],delete a[i])}),(l[0]||l[1])&&(e.data("revert",s),n.push("-webkit-transform"+o),g(e,"translate3d("+l.join(",")+")","transform"))),t.each(a,function(t){n.push(t+o)}),g(e,n.join(",")),e.css(a)}}(a,u,f,r),2),void 0):(i.setTimeout(function(){b.complete.call(a[0])},b.duration),void 0)):(a.animate(f,b),void 0):(a.css(f),b.complete.call(a[0]),void 0)}}(),removeAlpha:function(t){if(9>m&&t){var e=t.style,i=t.currentStyle,a=i&&i.filter||e.filter||"";/alpha/.test(a)&&(e.filter=a.replace(/alpha\([^)]*\)/i,""))}},forceStyles:function(e,i){e=t(e),e.attr("style")&&e.data("styles",e.attr("style")).removeAttr("style"),e.css(i)},revertStyles:function(){t.each($.array(arguments),function(e,i){i=t(i),i.removeAttr("style"),i.attr("style",""),i.data("styles")&&i.attr("style",i.data("styles")).data("styles",null)})},moveOut:function(t){$.forceStyles(t,{position:"absolute",left:-1e4})},moveIn:function(){$.revertStyles.apply($,$.array(arguments))},elem:function(e){return e instanceof t?{$:e,dom:e[0]}:{$:t(e),dom:e}},hide:function(t,e,i){i=i||p;var a=$.elem(t),n=a.$;t=a.dom,n.data("opacity")||n.data("opacity",n.css("opacity"));var o={opacity:0};if(e){var r=9>m&&t?function(){$.removeAlpha(t),t.style.visibility="hidden",i.call(t)}:i;$.animate(t,o,{duration:e,complete:r,stop:!0})}else 9>m&&t?($.removeAlpha(t),t.style.visibility="hidden"):n.css(o)},show:function(t,e,i){i=i||p;var a=$.elem(t),n=a.$;t=a.dom;var o=parseFloat(n.data("opacity"))||1,r={opacity:o};if(e){9>m&&(n.css("opacity",0),t.style.visibility="visible");var s=9>m&&t?function(){1==r.opacity&&$.removeAlpha(t),i.call(t)}:i;$.animate(t,r,{duration:e,complete:s,stop:!0})}else 9>m&&1==r.opacity&&t?($.removeAlpha(t),t.style.visibility="visible"):n.css(r)},optimizeTouch:function(){var e,i,a,n,o={},r=function(e){e.preventDefault(),o=t.extend({},e,!0)},s=function(){this.evt=o},l=function(){this.handler.call(e,this.evt)};return function(o){t(o).bind("touchend",function(o){for(e=o.target,n=!0;e.parentNode&&e!=o.currentTarget&&n;)i=t(e).data("events"),a=t(e).data("fakes"),i&&"click"in i?(n=!1,o.preventDefault(),t(e).click(r).click(),i.click.pop(),t.each(i.click,s),t(e).data("fakes",i.click),delete i.click):a&&(n=!1,o.preventDefault(),t.each(a,l)),e=e.parentNode})}}(),addTimer:function(){return k.add.apply(k,$.array(arguments)),this},clearTimer:function(){return k.clear.apply(k,$.array(arguments)),this},wait:function(e){e=t.extend({until:g,success:p,error:function(){Galleria.raise("Could not complete wait function.")},timeout:3e3},e);var a,n,o=$.timestamp(),r=function(){return n=$.timestamp(),a=n-o,e.until(a)?(e.success(),!1):"number"==typeof e.timeout&&n>=o+e.timeout?(e.error(),!1):(i.setTimeout(r,10),void 0)};i.setTimeout(r,10)},toggleQuality:function(t,e){7!==m&&8!==m||!t||"IMG"!=t.nodeName.toUpperCase()||("undefined"==typeof e&&(e="nearest-neighbor"===t.style.msInterpolationMode),t.style.msInterpolationMode=e?"bicubic":"nearest-neighbor")},insertStyleTag:function(t){var e=a.createElement("style");if(f().head.appendChild(e),e.styleSheet)e.styleSheet.cssText=t;else{var i=a.createTextNode(t);e.appendChild(i)}},loadScript:function(e,i){var a=!1,n=t("<script>").attr({src:e,async:!0}).get(0);n.onload=n.onreadystatechange=function(){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a=!0,n.onload=n.onreadystatechange=null,"function"==typeof i&&i.call(this,this))},f().head.appendChild(n)},parseValue:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=t.match(/\-?\d|\./g);return e&&e.constructor===Array?1*e.join(""):0}return 0},timestamp:function(){return(new Date).getTime()},loadCSS:function(n,o,r){var s,l,c=!1,h=function(){var t=new Image;t.onload=t.onerror=function(){t=null,c=!0},t.src=n};return t("link[rel=stylesheet]").each(function(){return new RegExp(n).test(this.href)?(s=this,!1):void 0}),"function"==typeof o&&(r=o,o=e),r=r||p,s?(r.call(s,s),s):(l=a.styleSheets.length,t("#"+o).length?(t("#"+o).attr("href",n),l--,c=!0):(s=t("<link>").attr({rel:"stylesheet",href:n,id:o}).get(0),i.setTimeout(function(){var e=t('link[rel="stylesheet"], style');if(e.length?e.get(0).parentNode.insertBefore(s,e[0]):f().head.appendChild(s),m){if(l>=31)return Galleria.raise("You have reached the browser stylesheet limit (31)",!0),void 0;s.onreadystatechange=function(){c||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(c=!0)}}else{var o=a.createElement("a"),r=i.location;o.href=n,/file/.test(r.protocol)||r.hostname!=o.hostname||r.port!=o.port||r.protocol!=o.protocol?h():t.ajax({url:n,success:function(){c=!0},error:h})}},10)),"function"==typeof r&&$.wait({until:function(){return c&&a.styleSheets.length>l},success:function(){i.setTimeout(function(){r.call(s,s)},100)},error:function(){Galleria.raise("Theme CSS could not load",!0)},timeout:1e4}),s)}}}(),D=function(){var e=function(e,i,a,n){var o=this.getOptions("easing"),r=this.getStageWidth(),s={left:r*(e.rewind?-1:1)},l={left:0};a?(s.opacity=0,l.opacity=1):s.opacity=1,t(e.next).css(s),$.animate(e.next,l,{duration:e.speed,complete:function(t){return function(){i(),t.css({left:0})}}(t(e.next).add(e.prev)),queue:!1,easing:o}),n&&(e.rewind=!e.rewind),e.prev&&(s={left:0},l={left:r*(e.rewind?1:-1)},a&&(s.opacity=1,l.opacity=0),t(e.prev).css(s),$.animate(e.prev,l,{duration:e.speed,queue:!1,easing:o,complete:function(){t(this).css("opacity",0)}}))};return{fade:function(e,i){t(e.next).css({opacity:0,left:0}).show(),$.animate(e.next,{opacity:1},{duration:e.speed,complete:i}),e.prev&&(t(e.prev).css("opacity",1).show(),$.animate(e.prev,{opacity:0},{duration:e.speed}))},flash:function(e,i){t(e.next).css({opacity:0,left:0}),e.prev?$.animate(e.prev,{opacity:0},{duration:e.speed/2,complete:function(){$.animate(e.next,{opacity:1},{duration:e.speed,complete:i})}}):$.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},pulse:function(e,i){e.prev&&t(e.prev).hide(),t(e.next).css({opacity:0,left:0}).show(),$.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},slide:function(){e.apply(this,$.array(arguments))},fadeslide:function(){e.apply(this,$.array(arguments).concat([!0]))},doorslide:function(){e.apply(this,$.array(arguments).concat([!1,!0]))}}}();T.listen(),Galleria=function(){var a=this;this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._layers=[],this._initialized=!1,this._firstrun=!1,this._stageWidth=0,this._stageHeight=0,this._target=e,this._binds=[],this._id=parseInt(1e4*Math.random(),10);var r="container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip",s="current total";t.each(r.split(" "),function(t,e){a._dom[e]=$.create("galleria-"+e)}),t.each(s.split(" "),function(t,e){a._dom[e]=$.create("galleria-"+e,"span")});var l=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var e=t.keyCode||t.which;e in l.map&&"function"==typeof l.map[e]&&l.map[e].call(a,t)},attach:function(t){var e,i;for(e in t)t.hasOwnProperty(e)&&(i=e.toUpperCase(),i in l.keys?l.map[l.keys[i]]=t[e]:l.map[i]=t[e]);l.bound||(l.bound=!0,n.bind("keydown",l.press))},detach:function(){l.bound=!1,l.map={},n.unbind("keydown",l.press)}},c=this._controls={0:e,1:e,active:0,swap:function(){c.active=c.active?0:1},getActive:function(){return c[c.active]},getNext:function(){return c[1-c.active]}},h=this._carousel={next:a.$("thumb-nav-right"),prev:a.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var e=0,i=0,n=[0];t.each(a._thumbnails,function(a,o){o.ready&&(e+=o.outerWidth||t(o.container).outerWidth(!0),n[a+1]=e,i=Math.max(i,o.outerHeight||t(o.container).outerHeight(!0)))}),a.$("thumbnails").css({width:e,height:i}),h.max=e,h.hooks=n,h.width=a.$("thumbnails-list").width(),h.setClasses(),a.$("thumbnails-container").toggleClass("galleria-carousel",e>h.width),h.width=a.$("thumbnails-list").width()},bindControls:function(){var t;h.next.bind("click",function(e){if(e.preventDefault(),"auto"===a._options.carouselSteps){for(t=h.current;t<h.hooks.length;t++)if(h.hooks[t]-h.hooks[h.current]>h.width){h.set(t-2);break}}else h.set(h.current+a._options.carouselSteps)}),h.prev.bind("click",function(e){if(e.preventDefault(),"auto"===a._options.carouselSteps)for(t=h.current;t>=0;t--){if(h.hooks[h.current]-h.hooks[t]>h.width){h.set(t+2);break}if(0===t){h.set(0);break}}else h.set(h.current-a._options.carouselSteps)})},set:function(t){for(t=Math.max(t,0);h.hooks[t-1]+h.width>=h.max&&t>=0;)t--;h.current=t,h.animate()},getLast:function(t){return(t||h.current)-1},follow:function(t){if(0===t||t===h.hooks.length-2)return h.set(t),void 0;for(var e=h.current;h.hooks[e]-h.hooks[h.current]<h.width&&e<=h.hooks.length;)e++;t-1<h.current?h.set(t-1):t+2>e&&h.set(t-e+h.current+2)},setClasses:function(){h.prev.toggleClass("disabled",!h.current),h.next.toggleClass("disabled",h.hooks[h.current]+h.width>=h.max)},animate:function(){h.setClasses();var t=-1*h.hooks[h.current];isNaN(t)||$.animate(a.get("thumbnails"),{left:t},{duration:a._options.carouselSpeed,easing:a._options.easing,queue:!1})}},u=this._tooltip={initialized:!1,open:!1,timer:"tooltip"+a._id,swapTimer:"swap"+a._id,init:function(){u.initialized=!0;var t=".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}";$.insertStyleTag(t),a.$("tooltip").css({opacity:.8,visibility:"visible",display:"none"})},move:function(t){var e=a.getMousePosition(t).x,i=a.getMousePosition(t).y,n=a.$("tooltip"),o=e,r=i,s=n.outerHeight(!0)+1,l=n.outerWidth(!0),c=s+15,h=a.$("container").width()-l-2,u=a.$("container").height()-s-2;isNaN(o)||isNaN(r)||(o+=10,r-=30,o=Math.max(0,Math.min(h,o)),r=Math.max(0,Math.min(u,r)),c>i&&(r=c),n.css({left:o,top:r}))},bind:function(e,i){if(!Galleria.TOUCH){u.initialized||u.init();var n=function(e,i){u.define(e,i),t(e).hover(function(){$.clearTimer(u.swapTimer),a.$("container").unbind("mousemove",u.move).bind("mousemove",u.move).trigger("mousemove"),u.show(e),$.addTimer(u.timer,function(){a.$("tooltip").stop().show().animate({opacity:1}),u.open=!0},u.open?0:500)},function(){a.$("container").unbind("mousemove",u.move),$.clearTimer(u.timer),a.$("tooltip").stop().animate({opacity:0},200,function(){a.$("tooltip").hide(),$.addTimer(u.swapTimer,function(){u.open=!1},1e3)})}).click(function(){t(this).trigger("mouseout")})};"string"==typeof i?n(e in a._dom?a.get(e):e,i):t.each(e,function(t,e){n(a.get(t),e)})}},show:function(e){e=t(e in a._dom?a.get(e):e);var n=e.data("tt"),o=function(t){i.setTimeout(function(t){return function(){u.move(t)}}(t),10),e.unbind("mouseup",o)};n="function"==typeof n?n():n,n&&(a.$("tooltip").html(n.replace(/\s/,"&nbsp;")),e.bind("mouseup",o))},define:function(e,i){if("function"!=typeof i){var n=i;i=function(){return n}}e=t(e in a._dom?a.get(e):e).data("tt",i),u.show(e)}},d=this._fullscreen={scrolled:0,crop:e,transition:e,active:!1,keymap:a._keyboard.map,enter:function(t){a._options.trueFullscreen&&T.support?T.enter(a,t):d._enter(t)},_enter:function(i){d.active=!0,$.hide(a.getActiveImage()),a.$("container").addClass("fullscreen"),d.scrolled=o.scrollTop(),$.forceStyles(a.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});var n={height:"100%",overflow:"hidden",margin:0,padding:0},r=a.getData(),s=a._options;if($.forceStyles(f().html,n),$.forceStyles(f().body,n),d.keymap=t.extend({},a._keyboard.map),a.attachKeyboard({escape:a.exitFullscreen,right:a.next,left:a.prev}),d.crop=s.imageCrop,s.fullscreenCrop!=e&&(s.imageCrop=s.fullscreenCrop),r&&r.big&&r.image!==r.big){var l=new Galleria.Picture,c=l.isCached(r.big),h=a.getIndex(),u=a._thumbnails[h];a.trigger({type:Galleria.LOADSTART,cached:c,rewind:!1,index:h,imageTarget:a.getActiveImage(),thumbTarget:u,galleriaData:r}),l.load(r.big,function(e){a._scaleImage(e,{complete:function(e){a.trigger({type:Galleria.LOADFINISH,cached:c,index:h,rewind:!1,imageTarget:e.image,thumbTarget:u});var i=a._controls.getActive().image;i&&t(i).width(e.image.width).height(e.image.height).attr("style",t(e.image).attr("style")).attr("src",e.image.src)}})})}a.rescale(function(){$.addTimer(!1,function(){$.show(a.getActiveImage()),"function"==typeof i&&i.call(a)},100),a.trigger(Galleria.FULLSCREEN_ENTER)}),o.resize(function(){d.scale()})},scale:function(){a.rescale()},exit:function(t){a._options.trueFullscreen&&T.support?T.exit(t):d._exit(t)},_exit:function(t){d.active=!1,$.hide(a.getActiveImage()),a.$("container").removeClass("fullscreen"),$.revertStyles(a.get("container"),f().html,f().body),i.scrollTo(0,d.scrolled),a.detachKeyboard(),a.attachKeyboard(d.keymap),a._options.imageCrop=d.crop;var e=a.getData().big,n=a._controls.getActive().image;!a.getData().iframe&&n&&e&&e==n.src&&i.setTimeout(function(t){return function(){n.src=t}}(a.getData().image),1),a.rescale(function(){$.addTimer(!1,function(){$.show(a.getActiveImage()),"function"==typeof t&&t.call(a),o.trigger("resize")},50),a.trigger(Galleria.FULLSCREEN_EXIT)}),o.unbind("resize",d.scale)}},p=this._idle={timer:"idle"+a._id,trunk:[],bound:!1,add:function(e,i){if(e){p.bound||p.addEvent(),e=t(e);var a,n={};for(a in i)i.hasOwnProperty(a)&&(n[a]=e.css(a));e.data("idle",{from:n,to:i,complete:!0,busy:!1}),p.addTimer(),p.trunk.push(e)}},remove:function(e){e=jQuery(e),t.each(p.trunk,function(t,i){i&&i.length&&!i.not(e).length&&(a._idle.show(e),a._idle.trunk.splice(t,1))}),p.trunk.length||(p.removeEvent(),$.clearTimer(p.timer))},addEvent:function(){p.bound=!0,a.$("container").bind("mousemove click",p.showAll)},removeEvent:function(){p.bound=!1,a.$("container").unbind("mousemove click",p.showAll)},addTimer:function(){$.addTimer(p.timer,function(){p.hide()},a._options.idleTime)},hide:function(){a._options.idleMode&&a.getIndex()!==!1&&!a.getData().iframe&&(a.trigger(Galleria.IDLE_ENTER),t.each(p.trunk,function(t,e){var i=e.data("idle");i&&(e.data("idle").complete=!1,$.animate(e,i.to,{duration:a._options.idleSpeed}))}))},showAll:function(){$.clearTimer(p.timer),t.each(p.trunk,function(t,e){p.show(e)})},show:function(e){var i=e.data("idle");i.busy||i.complete||(i.busy=!0,a.trigger(Galleria.IDLE_EXIT),$.clearTimer(p.timer),$.animate(e,i.from,{duration:a._options.idleSpeed/2,complete:function(){t(this).data("idle").busy=!1,t(this).data("idle").complete=!0}})),p.addTimer()}},g=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){if(a.trigger(Galleria.LIGHTBOX_OPEN),!g.initialized){g.initialized=!0;var e="overlay box content shadow title info close prevholder prev nextholder next counter image",i={},n=a._options,o="",r="position:absolute;",s="lightbox-",l={overlay:"position:fixed;display:none;opacity:"+n.overlayOpacity+";filter:alpha(opacity="+100*n.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+n.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:r+"background:#000;width:100%;height:100%;",content:r+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:r+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:r+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:r+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:r+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:r+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:r+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:r+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},c=function(e){return e.hover(function(){t(this).css("color","#bbb")},function(){t(this).css("color","#444")})},h={};m&&m>7&&(l.nextholder+="background:#000;filter:alpha(opacity=0);",l.prevholder+="background:#000;filter:alpha(opacity=0);"),t.each(l,function(t,e){o+=".galleria-"+s+t+"{"+e+"}"}),o+=".galleria-"+s+"box.iframe .galleria-"+s+"prevholder,.galleria-"+s+"box.iframe .galleria-"+s+"nextholder{width:100px;height:100px;top:50%;margin-top:-70px}",$.insertStyleTag(o),t.each(e.split(" "),function(t,e){a.addElement("lightbox-"+e),i[e]=g.elems[e]=a.get("lightbox-"+e)}),g.image=new Galleria.Picture,t.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(e,i){var a=[];t.each(i.split(" "),function(t,e){a.push(s+e)}),h[s+e]=a}),a.append(h),t(i.image).append(g.image.container),t(f().body).append(i.overlay,i.box),$.optimizeTouch(i.box),c(t(i.close).bind("click",g.hide).html("&#215;")),t.each(["Prev","Next"],function(e,a){var n=t(i[a.toLowerCase()]).html(/v/.test(a)?"&#8249;&nbsp;":"&nbsp;&#8250;"),o=t(i[a.toLowerCase()+"holder"]);return o.bind("click",function(){g["show"+a]()}),8>m||Galleria.TOUCH?(n.show(),void 0):(o.hover(function(){n.show()},function(){n.stop().fadeOut(200)}),void 0)}),t(i.overlay).bind("click",g.hide),Galleria.IPAD&&(a._options.lightboxTransitionSpeed=0)}},rescale:function(e){var i=Math.min(o.width()-40,g.width),n=Math.min(o.height()-60,g.height),r=Math.min(i/g.width,n/g.height),s=Math.round(g.width*r)+40,l=Math.round(g.height*r)+60,c={width:s,height:l,"margin-top":-1*Math.ceil(l/2),"margin-left":-1*Math.ceil(s/2)};e?t(g.elems.box).css(c):t(g.elems.box).animate(c,{duration:a._options.lightboxTransitionSpeed,easing:a._options.easing,complete:function(){var e=g.image,i=a._options.lightboxFadeSpeed;a.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:e.image}),t(e.container).show(),t(e.image).animate({opacity:1},i),$.show(g.elems.info,i)}})},hide:function(){g.image.image=null,o.unbind("resize",g.rescale),t(g.elems.box).hide(),$.hide(g.elems.info),a.detachKeyboard(),a.attachKeyboard(g.keymap),g.keymap=!1,$.hide(g.elems.overlay,200,function(){t(this).hide().css("opacity",a._options.overlayOpacity),a.trigger(Galleria.LIGHTBOX_CLOSE)})},showNext:function(){g.show(a.getNext(g.active))},showPrev:function(){g.show(a.getPrev(g.active))},show:function(e){g.active=e="number"==typeof e?e:a.getIndex()||0,g.initialized||g.init(),g.keymap||(g.keymap=t.extend({},a._keyboard.map),a.attachKeyboard({escape:g.hide,right:g.showNext,left:g.showPrev})),o.unbind("resize",g.rescale);var n,r,s,l=a.getData(e),c=a.getDataLength(),h=a.getNext(e);$.hide(g.elems.info);try{for(s=a._options.preload;s>0;s--)r=new Galleria.Picture,n=a.getData(h),r.preload("big"in n?n.big:n.image),h=a.getNext(h)}catch(u){}g.image.isIframe=!!l.iframe,t(g.elems.box).toggleClass("iframe",!!l.iframe),g.image.load(l.iframe||l.big||l.image,function(a){g.width=a.isIframe?t(i).width():a.original.width,g.height=a.isIframe?t(i).height():a.original.height,t(a.image).css({width:a.isIframe?"100%":"100.1%",height:a.isIframe?"100%":"100.1%",top:0,zIndex:99998,opacity:0,visibility:"visible"}),g.elems.title.innerHTML=l.title||"",g.elems.counter.innerHTML=e+1+" / "+c,o.resize(g.rescale),g.rescale()}),t(g.elems.overlay).show().css("visibility","visible"),t(g.elems.box).show()}};return this},Galleria.prototype={constructor:Galleria,init:function(i,a){return a=y(a),this._original={target:i,options:a,data:null},this._target=this._dom.target=i.nodeName?i:t(i).get(0),this._original.html=this._target.innerHTML,G.push(this),this._target?(this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(){return{}},dataSelector:"img",dataSource:this._target,debug:e,dummy:e,easing:"galleria",extend:function(){},fullscreenCrop:e,fullscreenDoubleTap:!0,fullscreenTransition:e,height:0,idleMode:!0,idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:e,initialTransition:e,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:e,minScaleRatio:e,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,responsive:!1,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:!0,thumbCrop:!0,thumbEventType:"click",thumbFit:!0,thumbMargin:0,thumbQuality:"auto",thumbnails:!0,touchTransition:e,transition:"fade",transitionInitial:e,transitionSpeed:400,trueFullscreen:!0,useCanvas:!1,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5e3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,a&&a.debug===!1&&(l=!1),a&&"number"==typeof a.imageTimeout&&(c=a.imageTimeout),a&&"string"==typeof a.dummy&&(h=a.dummy),t(this._target).children().hide(),"object"==typeof Galleria.theme?this._init():E.push(this),this):(Galleria.raise("Target not found",!0),void 0)
},_init:function(){var e=this,n=this._options;if(this._initialized)return Galleria.raise("Init failed: Gallery instance already initialized."),this;if(this._initialized=!0,!Galleria.theme)return Galleria.raise("Init failed: No theme found.",!0),this;if(t.extend(!0,n,Galleria.theme.defaults,this._original.options,Galleria.configure.options),function(t){return"getContext"in t?(I=I||{elem:t,context:t.getContext("2d"),cache:{},length:0},void 0):(t=null,void 0)}(a.createElement("canvas")),this.bind(Galleria.DATA,function(){Galleria.QUIRK&&Galleria.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML."),this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();var t=this.$("container"),a={width:0,height:0},n=function(){return e.$("stage").height()};$.wait({until:function(){return a=e._getWH(),t.width(a.width).height(a.height),n()&&a.width&&a.height>50},success:function(){e._width=a.width,e._height=a.height,Galleria.WEBKIT?i.setTimeout(function(){e._run()},1):e._run()},error:function(){n()?Galleria.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+a.width+"px, height: "+a.height+"px.",!0):Galleria.raise("Could not extract a stage height from the CSS. Traced height: "+n()+"px.",!0)},timeout:"number"==typeof this._options.wait?this._options.wait:!1})}),this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),$.hide(this.$("counter").append(this.get("current"),a.createTextNode(" / "),this.get("total"))),this.setCounter("&#8211;"),$.hide(e.get("tooltip")),this.$("container").addClass(Galleria.TOUCH?"touch":"notouch"),t.each(new Array(2),function(i){var a=new Galleria.Picture;t(a.container).css({position:"absolute",top:0,left:0}).prepend(e._layers[i]=t($.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]),e.$("images").append(a.container),e._controls[i]=a}),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").bind("click",function(t){n.clicknext&&t.stopPropagation(),n.pauseOnInteraction&&e.pause();var i=/right/.test(this.className)?"next":"prev";e[i]()}),t.each(["info","counter","image-nav"],function(t,i){n["show"+i.substr(0,1).toUpperCase()+i.substr(1).replace(/-/,"")]===!1&&$.moveOut(e.get(i.toLowerCase()))}),this.load(),n.keepSource||m||(this._target.innerHTML=""),this.get("errors")&&this.appendChild("target","errors"),this.appendChild("target","container"),n.carousel){var r=0,s=n.show;this.bind(Galleria.THUMBNAIL,function(){this.updateCarousel(),++r==this.getDataLength()&&"number"==typeof s&&s>0&&this._carousel.follow(s)})}return n.responsive&&o.bind("resize",function(){e.isFullscreen()||e.resize()}),n.swipe&&(!function(t){var i,a=[0,0],n=[0,0],o=30,r=100,s=!1,l=0,c={start:"touchstart",move:"touchmove",stop:"touchend"},h=function(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t},u=function(t){t.originalEvent.touches&&t.originalEvent.touches.length>1||(i=h(t),n=[i.pageX,i.pageY],a[0]||(a=n),Math.abs(a[0]-n[0])>10&&t.preventDefault())},d=function(i){return t.unbind(c.move,u),i.originalEvent.touches&&i.originalEvent.touches.length||s?(s=!s,void 0):($.timestamp()-l<1e3&&Math.abs(a[0]-n[0])>o&&Math.abs(a[1]-n[1])<r&&(i.preventDefault(),e[a[0]>n[0]?"next":"prev"]()),a=n=[0,0],void 0)};t.bind(c.start,function(e){e.originalEvent.touches&&e.originalEvent.touches.length>1||(i=h(e),l=$.timestamp(),a=n=[i.pageX,i.pageY],t.bind(c.move,u).one(c.stop,d))})}(e.$("images")),n.fullscreenDoubleTap&&this.$("stage").bind("touchstart",function(){var t,i,a,n,o,r,s=function(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t};return function(l){return r=Galleria.utils.timestamp(),i=s(l).pageX,a=s(l).pageY,500>r-t&&20>i-n&&20>a-o?(e.toggleFullscreen(),l.preventDefault(),e.$("stage").unbind("touchend",arguments.callee),void 0):(t=r,n=i,o=a,void 0)}}())),$.optimizeTouch(this.get("container")),t.each(Galleria.on.binds,function(i,a){-1==t.inArray(a.hash,e._binds)&&e.bind(a.type,a.callback)}),this},_getWH:function(){var e,i=this.$("container"),a=this.$("target"),n=this,o={};return t.each(["width","height"],function(t,r){n._options[r]&&"number"==typeof n._options[r]?o[r]=n._options[r]:(e=[$.parseValue(i.css(r)),$.parseValue(a.css(r)),i[r](),a[r]()],n["_"+r]||e.splice(e.length,$.parseValue(i.css("min-"+r)),$.parseValue(a.css("min-"+r))),o[r]=Math.max.apply(Math,e))}),n._options.height&&n._options.height<2&&(o.height=o.width*n._options.height),o},_createThumbnails:function(){this.get("total").innerHTML=this.getDataLength();var e,n,o,r,s,l,c=this,h=this._options,u=function(){var t=c.$("thumbnails").find(".active");return t.length?t.find("img").attr("src"):!1}(),d="string"==typeof h.thumbnails?h.thumbnails.toLowerCase():null,p=function(t){return a.defaultView&&a.defaultView.getComputedStyle?a.defaultView.getComputedStyle(o.container,null)[t]:l.css(t)},g=function(e,i,a){return function(){t(a).append(e),c.trigger({type:Galleria.THUMBNAIL,thumbTarget:e,index:i,galleriaData:c.getData(i)})}},m=function(e){h.pauseOnInteraction&&c.pause();var i=t(e.currentTarget).data("index");c.getIndex()!==i&&c.show(i),e.preventDefault()},f=function(e){e.scale({width:e.data.width,height:e.data.height,crop:h.thumbCrop,margin:h.thumbMargin,canvas:h.useCanvas,complete:function(e){var i,a,n=["left","top"],o=["Width","Height"],r=c.getData(e.index),s=r.thumb.split(":");t.each(o,function(o,r){i=r.toLowerCase(),h.thumbCrop===!0&&h.thumbCrop!==i||!h.thumbFit||(a={},a[i]=e[i],t(e.container).css(a),a={},a[n[o]]=0,t(e.image).css(a)),e["outer"+r]=t(e.container)["outer"+r](!0)}),$.toggleQuality(e.image,h.thumbQuality===!0||"auto"===h.thumbQuality&&e.original.width<3*e.width),r.iframe&&2==s.length&&s[0]in w&&w[s[0]].getThumb(s[1],function(t){return function(e){t.src=e}}(e.image)),c.trigger({type:Galleria.THUMBNAIL,thumbTarget:e.image,index:e.data.order,galleriaData:c.getData(e.data.order)})}})};for(this._thumbnails=[],this.$("thumbnails").empty(),e=0;this._data[e];e++)r=this._data[e],h.thumbnails===!0&&(r.thumb||r.image)?(o=new Galleria.Picture(e),o.index=e,n=r.thumb||r.image,this.$("thumbnails").append(o.container),l=t(o.container),o.data={width:$.parseValue(p("width")),height:$.parseValue(p("height")),order:e},h.thumbFit&&h.thumbCrop!==!0?l.css({width:"auto",height:"auto"}):l.css({width:o.data.width,height:o.data.height}),s=n.split(":"),2==s.length&&s[0]in w?o.load("data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",{height:o.data.height,width:1.25*o.data.height},f):o.load(n,f),"all"===h.preload&&o.preload(r.image)):r.iframe||"empty"===d||"numbers"===d?(o={container:$.create("galleria-image"),image:$.create("img","span"),ready:!0},"numbers"===d&&t(o.image).text(e+1),r.iframe&&t(o.image).addClass("iframe"),this.$("thumbnails").append(o.container),i.setTimeout(g(o.image,e,o.container),50+20*e)):o={container:null,image:null},t(o.container).add(h.keepSource&&h.linkSourceImages?r.original:null).data("index",e).bind(h.thumbEventType,m),u===n&&t(o.container).addClass("active"),this._thumbnails.push(o)},_run:function(){var a=this;a._createThumbnails(),$.wait({timeout:1e4,until:function(){return Galleria.OPERA&&a.$("stage").css("display","inline-block"),a._stageWidth=a.$("stage").width(),a._stageHeight=a.$("stage").height(),a._stageWidth&&a._stageHeight>50},success:function(){return S.push(a),$.show(a.get("counter")),a._options.carousel&&a._carousel.bindControls(),a._options.autoplay&&(a.pause(),"number"==typeof a._options.autoplay&&(a._playtime=a._options.autoplay),a.trigger(Galleria.PLAY),a._playing=!0),a._firstrun?("number"==typeof a._options.show&&a.show(a._options.show),void 0):(a._firstrun=!0,Galleria.History&&Galleria.History.change(function(t){isNaN(t)?i.history.go(-1):a.show(t,e,!0)}),a.trigger(Galleria.READY),Galleria.theme.init.call(a,a._options),t.each(Galleria.ready.callbacks,function(){this.call(a,a._options)}),a._options.extend.call(a,a._options),/^[0-9]{1,4}$/.test(d)&&Galleria.History?a.show(d,e,!0):a._data[a._options.show]&&a.show(a._options.show),void 0)},error:function(){Galleria.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+a._stageWidth+"px, height: "+a._stageHeight+"px.",!0)}})},load:function(e,i,a){var n=this;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof i&&(a=i,i=null),e=e||this._options.dataSource,i=i||this._options.dataSelector,a=a||this._options.dataConfig,/^function Object/.test(e.constructor)&&(e=[e]),e.constructor===Array?(this.validate(e)?(this._data=e,this._parseData().trigger(Galleria.DATA)):Galleria.raise("Load failed: JSON Array not valid."),this):(i+=",.video,.iframe",t(e).find(i).each(function(e,i){i=t(i);var o={},r=i.parent(),s=r.attr("href"),l=r.attr("rel");s&&("IMG"==i[0].nodeName||i.hasClass("video"))&&x(s)?o.video=s:s&&i.hasClass("iframe")?o.iframe=s:o.image=o.big=s,l&&(o.big=l),t.each("big title description link layer".split(" "),function(t,e){i.data(e)&&(o[e]=i.data(e))}),n._data.push(t.extend({title:i.attr("title")||"",thumb:i.attr("src"),image:i.attr("src"),big:i.attr("src"),description:i.attr("alt")||"",link:i.attr("longdesc"),original:i.get(0)},o,a(i)))}),this.getDataLength()&&this._parseData().trigger(Galleria.DATA),this)},_parseData:function(){var e,i=this;return t.each(this._data,function(a,n){if(e=i._data[a],"thumb"in n==!1&&(e.thumb=n.image),!1 in n&&(e.big=n.image),"video"in n){var o=x(n.video);o&&(e.iframe=w[o.provider].embed(o.id)+function(){if("object"==typeof i._options[o.provider]){var e="?",a=[];return t.each(i._options[o.provider],function(t,e){a.push(t+"="+e)}),"youtube"==o.provider&&(a=["wmode=opaque"].concat(a)),e+a.join("&")}return""}(),delete e.video,"thumb"in e&&e.thumb||(e.thumb=o.provider+":"+o.id))}}),this},destroy:function(){return this.get("target").innerHTML=this._original.html,this},splice:function(){var t=this,e=$.array(arguments);return i.setTimeout(function(){r.splice.apply(t._data,e),t._parseData()._createThumbnails()},2),t},push:function(){var t=this,e=$.array(arguments);return i.setTimeout(function(){r.push.apply(t._data,e),t._parseData()._createThumbnails()},2),t},_getActive:function(){return this._controls.getActive()},validate:function(){return!0},bind:function(t,e){return t=_(t),this.$("container").bind(t,this.proxy(e)),this},unbind:function(t){return t=_(t),this.$("container").unbind(t),this},trigger:function(e){return e="object"==typeof e?t.extend(e,{scope:this}):{type:_(e),scope:this},this.$("container").trigger(e),this},addIdleState:function(){return this._idle.add.apply(this._idle,$.array(arguments)),this},removeIdleState:function(){return this._idle.remove.apply(this._idle,$.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(){return this._fullscreen.enter.apply(this,$.array(arguments)),this},exitFullscreen:function(){return this._fullscreen.exit.apply(this,$.array(arguments)),this},toggleFullscreen:function(){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,$.array(arguments)),this},bindTooltip:function(){return this._tooltip.bind.apply(this._tooltip,$.array(arguments)),this},defineTooltip:function(){return this._tooltip.define.apply(this._tooltip,$.array(arguments)),this},refreshTooltip:function(){return this._tooltip.show.apply(this._tooltip,$.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,$.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,$.array(arguments)),this},getActiveImage:function(){return this._getActive().image||e},getActiveThumb:function(){return this._thumbnails[this._active].image||e},getMousePosition:function(t){return{x:t.pageX-this.$("container").offset().left,y:t.pageY-this.$("container").offset().top}},addPan:function(e){if(this._options.imageCrop!==!1){e=t(e||this.getActiveImage());var i=this,a=e.width()/2,n=e.height()/2,o=parseInt(e.css("left"),10),r=parseInt(e.css("top"),10),s=o||0,l=r||0,c=0,h=0,u=!1,d=$.timestamp(),p=0,g=0,f=function(t,i,a){if(t>0&&(g=Math.round(Math.max(-1*t,Math.min(0,i))),p!==g))if(p=g,8===m)e.parent()["scroll"+a](-1*g);else{var n={};n[a.toLowerCase()]=g,e.css(n)}},b=function(t){$.timestamp()-d<50||(u=!0,a=i.getMousePosition(t).x,n=i.getMousePosition(t).y)},v=function(){u&&(c=e.width()-i._stageWidth,h=e.height()-i._stageHeight,o=a/i._stageWidth*c*-1,r=n/i._stageHeight*h*-1,s+=(o-s)/i._options.imagePanSmoothness,l+=(r-l)/i._options.imagePanSmoothness,f(h,l,"Top"),f(c,s,"Left"))};return 8===m&&(e.parent().scrollTop(-1*l).scrollLeft(-1*s),e.css({top:0,left:0})),this.$("stage").unbind("mousemove",b).bind("mousemove",b),$.addTimer("pan"+i._id,v,50,!0),this}},proxy:function(t,e){return"function"!=typeof t?p:(e=e||this,function(){return t.apply(e,$.array(arguments))})},removePan:function(){return this.$("stage").unbind("mousemove"),$.clearTimer("pan"+this._id),this},addElement:function(){var e=this._dom;return t.each($.array(arguments),function(t,i){e[i]=$.create("galleria-"+i)}),this},attachKeyboard:function(){return this._keyboard.attach.apply(this._keyboard,$.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,$.array(arguments)),this},appendChild:function(t,e){return this.$(t).append(this.get(e)||e),this},prependChild:function(t,e){return this.$(t).prepend(this.get(e)||e),this},remove:function(){return this.$($.array(arguments).join(",")).remove(),this},append:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e))if(t[e].constructor===Array)for(i=0;t[e][i];i++)this.appendChild(e,t[e][i]);else this.appendChild(e,t[e]);return this},_scaleImage:function(e,i){if(e=e||this._controls.getActive()){var a,n=function(e){t(e.container).children(":first").css({top:Math.max(0,$.parseValue(e.image.style.top)),left:Math.max(0,$.parseValue(e.image.style.left)),width:$.parseValue(e.image.width),height:$.parseValue(e.image.height)})};return i=t.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition},i),this._options.layerFollow&&this._options.imageCrop!==!0?"function"==typeof i.complete?(a=i.complete,i.complete=function(){a.call(e,e),n(e)}):i.complete=n:t(e.container).children(":first").css({top:0,left:0}),e.scale(i),this}},updateCarousel:function(){return this._carousel.update(),this},resize:function(i,a){"function"==typeof i&&(a=i,i=e),i=t.extend({width:0,height:0},i);var n,o=this,r=this.$("container"),s=!("aspect"!=this._options.responsive||i.width&&i.height);return t.each(i,function(t,e){e||(r[t]("auto"),i[t]=o._getWH()[t])}),s&&(n=Math.min(i.width/this._width,i.height/this._height)),t.each(i,function(t,e){r[t](n?n*o["_"+t]:e)}),this.rescale(a)},rescale:function(t,i,a){var n=this;"function"==typeof t&&(a=t,t=e);var o=function(){n._stageWidth=t||n.$("stage").width(),n._stageHeight=i||n.$("stage").height(),n._scaleImage(),n._options.carousel&&n.updateCarousel(),n.trigger(Galleria.RESCALE),"function"==typeof a&&a.call(n)};return!Galleria.WEBKIT||Galleria.TOUCH||t||i?o.call(n):$.addTimer(!1,o,10),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(t,e,i){return t===!1||!this._options.queue&&this._queue.stalled?void 0:(t=Math.max(0,Math.min(parseInt(t,10),this.getDataLength()-1)),e="undefined"!=typeof e?!!e:t<this.getIndex(),i=i||!1,!i&&Galleria.History?(Galleria.History.set(t.toString()),void 0):(this._active=t,r.push.call(this._queue,{index:t,rewind:e}),this._queue.stalled||this._show(),this))},_show:function(){var a=this,n=this._queue[0],o=this.getData(n.index);if(o){var s=o.iframe||(this.isFullscreen()&&"big"in o?o.big:o.image),l=this._controls.getActive(),c=this._controls.getNext(),h=c.isCached(s),u=this._thumbnails[n.index],d=function(){t(c.image).trigger("mouseup")},p=function(e,n,o,s,l){return function(){var c;a._queue.stalled=!1,$.toggleQuality(n.image,a._options.imageQuality),a._layers[a._controls.active].innerHTML="",t(o.container).css({zIndex:0,opacity:0}).show(),o.isIframe&&t(o.container).find("iframe").remove(),a.$("container").toggleClass("iframe",!!e.iframe),t(n.container).css({zIndex:1,left:0,top:0}).show(),a._controls.swap(),a._options.imagePan&&a.addPan(n.image),(e.link||a._options.lightbox||a._options.clicknext)&&t(n.image).css({cursor:"pointer"}).bind("mouseup",function(){return a._options.clicknext&&!Galleria.TOUCH?(a._options.pauseOnInteraction&&a.pause(),a.next(),void 0):e.link?(a._options.popupLinks?c=i.open(e.link,"_blank"):i.location.href=e.link,void 0):(a._options.lightbox&&a.openLightbox(),void 0)}),r.shift.call(a._queue),a._queue.length&&a._show(),a._playCheck(),a.trigger({type:Galleria.IMAGE,index:s.index,imageTarget:n.image,thumbTarget:l.image,galleriaData:e})}}(o,c,l,n,u);if(this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(n.index),this._options.preload){var g,m,f,b=this.getNext();try{for(m=this._options.preload;m>0;m--)g=new Galleria.Picture,f=a.getData(b),g.preload(this.isFullscreen()&&"big"in f?f.big:f.image),b=a.getNext(b)}catch(v){}}$.show(c.container),c.isIframe=!!o.iframe,t(a._thumbnails[n.index].container).addClass("active").siblings(".active").removeClass("active"),a.trigger({type:Galleria.LOADSTART,cached:h,index:n.index,rewind:n.rewind,imageTarget:c.image,thumbTarget:u.image,galleriaData:o}),c.load(s,function(i){var r=t(a._layers[1-a._controls.active]).html(o.layer||"").hide();a._scaleImage(i,{complete:function(i){"image"in l&&$.toggleQuality(l.image,!1),$.toggleQuality(i.image,!1),a._queue.stalled=!0,a.removePan(),a.setInfo(n.index),a.setCounter(n.index),o.layer&&(r.show(),(o.link||a._options.lightbox||a._options.clicknext)&&r.css("cursor","pointer").unbind("mouseup").mouseup(d)),a.trigger({type:Galleria.LOADFINISH,cached:h,index:n.index,rewind:n.rewind,imageTarget:i.image,thumbTarget:a._thumbnails[n.index].image,galleriaData:a.getData(n.index)});var s=a._options.transition;if(t.each({initial:null===l.image,touch:Galleria.TOUCH,fullscreen:a.isFullscreen()},function(t,i){return i&&a._options[t+"Transition"]!==e?(s=a._options[t+"Transition"],!1):void 0}),s in D==!1)p();else{var c={prev:l.container,next:i.container,rewind:n.rewind,speed:a._options.transitionSpeed||400};D[s].call(a,c,p)}}})})}},getNext:function(t){return t="number"==typeof t?t:this.getIndex(),t===this.getDataLength()-1?0:t+1},getPrev:function(t){return t="number"==typeof t?t:this.getIndex(),0===t?this.getDataLength()-1:t-1},next:function(){return this.getDataLength()>1&&this.show(this.getNext(),!1),this},prev:function(){return this.getDataLength()>1&&this.show(this.getPrev(),!0),this},get:function(t){return t in this._dom?this._dom[t]:null},getData:function(t){return t in this._data?this._data[t]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active?this._active:!1},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(t){return"undefined"==typeof t?this._options:this._options[t]},setOptions:function(e,i){return"object"==typeof e?t.extend(this._options,e):this._options[e]=i,this},play:function(t){return this._playing=!0,this._playtime=t||this._playtime,this._playCheck(),this.trigger(Galleria.PLAY),this},pause:function(){return this._playing=!1,this.trigger(Galleria.PAUSE),this},playToggle:function(t){return this._playing?this.pause():this.play(t)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var t=this,e=0,i=20,a=$.timestamp(),n="play"+this._id;if(this._playing){$.clearTimer(n);var o=function(){return e=$.timestamp()-a,e>=t._playtime&&t._playing?($.clearTimer(n),t.next(),void 0):(t._playing&&(t.trigger({type:Galleria.PROGRESS,percent:Math.ceil(e/t._playtime*100),seconds:Math.floor(e/1e3),milliseconds:e}),$.addTimer(n,o,i)),void 0)};$.addTimer(n,o,i)}},setPlaytime:function(t){return this._playtime=t,this},setIndex:function(t){return this._active=t,this},setCounter:function(t){if("number"==typeof t?t++:"undefined"==typeof t&&(t=this.getIndex()+1),this.get("current").innerHTML=t,m){var e=this.$("counter"),i=e.css("opacity");1===parseInt(i,10)?$.removeAlpha(e[0]):this.$("counter").css("opacity",i)}return this},setInfo:function(e){var i=this,a=this.getData(e);return t.each(["title","description"],function(t,e){var n=i.$("info-"+e);a[e]?n[a[e].length?"show":"hide"]().html(a[e]):n.empty().hide()}),this},hasInfo:function(t){var e,i="title description".split(" ");for(e=0;i[e];e++)if(this.getData(t)[i[e]])return!0;return!1},jQuery:function(e){var i=this,a=[];t.each(e.split(","),function(e,n){n=t.trim(n),i.get(n)&&a.push(n)});var n=t(i.get(a.shift()));return t.each(a,function(t,e){n=n.add(i.get(e))}),n},$:function(){return this.jQuery.apply(this,$.array(arguments))}},t.each(v,function(t,e){var i=/_/.test(e)?e.replace(/_/g,""):e;Galleria[e.toUpperCase()]="galleria."+i}),t.extend(Galleria,{IE9:9===m,IE8:8===m,IE7:7===m,IE6:6===m,IE:m,WEBKIT:/webkit/.test(u),CHROME:/chrome/.test(u),SAFARI:/safari/.test(u)&&!/chrome/.test(u),QUIRK:m&&a.compatMode&&"BackCompat"===a.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!i.opera,IPHONE:/iphone/.test(u),IPAD:/ipad/.test(u),ANDROID:/android/.test(u),TOUCH:"ontouchstart"in a}),Galleria.addTheme=function(t){return A(t),t},Galleria.loadTheme=function(a,n){var o=S.length,r=i.setTimeout(function(){Galleria.raise("Theme at "+a+" could not load, check theme path.",!0)},5e3);return Galleria.theme=e,$.loadScript(a,function(){if(i.clearTimeout(r),o){var e=[];t.each(Galleria.get(),function(i,a){var o=t.extend(a._original.options,{data_source:a._data},n);a.$("container").remove();var r=new Galleria;r._id=a._id,r.init(a._original.target,o),e.push(r)}),S=e}}),Galleria},Galleria.get=function(t){return G[t]?G[t]:"number"!=typeof t?G:(Galleria.raise("Gallery index "+t+" not found"),void 0)},Galleria.configure=function(e,i){var a={};return"string"==typeof e&&i?(a[e]=i,e=a):t.extend(a,e),Galleria.configure.options=a,t.each(Galleria.get(),function(t,e){e.setOptions(a)}),Galleria},Galleria.configure.options={},Galleria.on=function(e,i){if(e){i=i||p;var a=e+i.toString().replace(/\s/g,"")+$.timestamp();return t.each(Galleria.get(),function(t,n){n._binds.push(a),n.bind(e,i)}),Galleria.on.binds.push({type:e,callback:i,hash:a}),Galleria}},Galleria.on.binds=[],Galleria.run=function(e,i){return t(e||"#galleria").galleria(i),Galleria},Galleria.addTransition=function(t,e){return D[t]=e,Galleria},Galleria.utils=$,Galleria.log=function(){var e=$.array(arguments);if(!("console"in i&&"log"in i.console))return i.alert(e.join("<br>"));try{return i.console.log.apply(i.console,e)}catch(a){t.each(e,function(){i.console.log(this)})}},Galleria.ready=function(e){return t.each(S,function(t,i){e.call(i,i._options)}),Galleria.ready.callbacks.push(e),Galleria},Galleria.ready.callbacks=[],Galleria.raise=function(e,i){var a=i?"Fatal error":"Error",n={color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5},o=function(e){var o='<div style="padding:4px;margin:0 0 2px;background:#'+(i?"811":"222")+'";>'+(i?"<strong>"+a+": </strong>":"")+e+"</div>";t.each(G,function(){var t=this.$("errors"),e=this.$("target");t.length||(e.css("position","relative"),t=this.addElement("errors").appendChild("target","errors").$("errors").css(n)),t.append(o)}),G.length||t("<div>").css(t.extend(n,{position:"fixed"})).append(o).appendTo(f().body)};if(l){if(o(e),i)throw new Error(a+": "+e)}else if(i){if(C)return;C=!0,i=!1,o("Gallery could not load.")}},Galleria.version=s,Galleria.requires=function(t,e){return e=e||"You need to upgrade Galleria to version "+t+" to use one or more components.",Galleria.version<t&&Galleria.raise(e,!0),Galleria},Galleria.Picture=function(e){this.id=e||null,this.image=null,this.container=$.create("galleria-image"),t(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.isIframe=!1},Galleria.Picture.prototype={cache:{},show:function(){$.show(this.image)},hide:function(){$.moveOut(this.image)},clear:function(){this.image=null},isCached:function(t){return!!this.cache[t]},preload:function(e){t(new Image).load(function(t,e){return function(){e[t]=t}}(e,this.cache)).attr("src",e)},load:function(e,a,n){if("function"==typeof a&&(n=a,a=null),this.isIframe){var o="if"+(new Date).getTime();return this.image=t("<iframe>",{src:e,frameborder:0,id:o,allowfullscreen:!0,css:{visibility:"hidden"}})[0],t(this.container).find("iframe,img").remove(),this.container.appendChild(this.image),t("#"+o).load(function(e,a){return function(){i.setTimeout(function(){t(e.image).css("visibility","visible"),"function"==typeof a&&a.call(e,e)},10)}}(this,n)),this.container}this.image=new Image;var r=!1,s=!1,l=t(this.container),c=t(this.image),u=function(e,n,o){return function(){var r=function(){t(this).unbind("load"),e.original=a||{height:this.height,width:this.width},e.container.appendChild(this),e.cache[o]=o,"function"==typeof n&&i.setTimeout(function(){n.call(e,e)},1)};this.width&&this.height?r.call(this):i.setTimeout(function(e){return function(){e.width&&e.height?r.call(e):s?Galleria.raise("Could not extract width/height from image: "+e.src+". Traced measures: width:"+e.width+"px, height: "+e.height+"px."):(t(new Image).load(u).attr("src",e.src),s=!0)}}(this),2)}}(this,n,e);return l.find("iframe,img").remove(),c.css("display","block"),$.hide(this.image),t.each("minWidth minHeight maxWidth maxHeight".split(" "),function(t,e){c.css(e,/min/.test(e)?"0":"none")}),this.cache[e]?(c.load(u).attr("src",e),this.container):(c.load(u).error(function(){r?h?t(this).attr("src",h):Galleria.raise("Image not found: "+e):(r=!0,i.setTimeout(function(t,e){return function(){t.attr("src",e+"?"+$.timestamp())}}(t(this),e),50))}).attr("src",e),this.container)},scale:function(i){var a=this;if(i=t.extend({width:0,height:0,min:e,max:e,margin:0,complete:p,position:"center",crop:!1,canvas:!1},i),this.isIframe){t(this.image).width(i.width).height(i.height).removeAttr("width").removeAttr("height"),t(this.container).width(i.width).height(i.height),i.complete.call(a,a);try{this.image.contentWindow&&t(this.image.contentWindow).trigger("resize")}catch(n){}return this.container}if(!this.image)return this.container;var o,r,s,l=t(a.container);return $.wait({until:function(){return o=i.width||l.width()||$.parseValue(l.css("width")),r=i.height||l.height()||$.parseValue(l.css("height")),o&&r},success:function(){var e=(o-2*i.margin)/a.original.width,n=(r-2*i.margin)/a.original.height,l=Math.min(e,n),c=Math.max(e,n),h={"true":c,width:e,height:n,"false":l,landscape:a.original.width>a.original.height?c:l,portrait:a.original.width<a.original.height?c:l},u=h[i.crop.toString()],d="";i.max&&(u=Math.min(i.max,u)),i.min&&(u=Math.max(i.min,u)),t.each(["width","height"],function(e,i){t(a.image)[i](a[i]=a.image[i]=Math.round(a.original[i]*u))}),t(a.container).width(o).height(r),i.canvas&&I&&(I.elem.width=a.width,I.elem.height=a.height,d=a.image.src+":"+a.width+"x"+a.height,a.image.src=I.cache[d]||function(t){I.context.drawImage(a.image,0,0,a.original.width*u,a.original.height*u);try{return s=I.elem.toDataURL(),I.length+=s.length,I.cache[t]=s,s}catch(e){return a.image.src}}(d));var p={},g={},m=function(e,i,n){var o=0;if(/\%/.test(e)){var r=parseInt(e,10)/100,s=a.image[i]||t(a.image)[i]();o=Math.ceil(-1*s*r+n*r)}else o=$.parseValue(e);return o},f={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};t.each(i.position.toLowerCase().split(" "),function(t,e){"center"===e&&(e="50%"),p[t?"top":"left"]=e}),t.each(p,function(e,i){f.hasOwnProperty(i)&&t.extend(g,f[i])}),p=p.top?t.extend(p,g):g,p=t.extend({top:"50%",left:"50%"},p),t(a.image).css({position:"absolute",top:m(p.top,"height",r),left:m(p.left,"width",o)}),a.show(),a.ready=!0,i.complete.call(a,a)},error:function(){Galleria.raise("Could not scale image: "+a.image.src)},timeout:1e3}),this}},t.extend(t.easing,{galleria:function(t,e,i,a,n){return(e/=n/2)<1?a/2*e*e*e+i:a/2*((e-=2)*e*e+2)+i},galleriaIn:function(t,e,i,a,n){return a*(e/=n)*e+i},galleriaOut:function(t,e,i,a,n){return-a*(e/=n)*(e-2)+i}}),t.fn.galleria=function(e){var i=this.selector;return t(this).length?this.each(function(){t.data(this,"galleria")||t.data(this,"galleria",(new Galleria).init(this,e))}):(t(function(){t(i).length?t(i).galleria(e):Galleria.utils.wait({until:function(){return t(i).length},success:function(){t(i).galleria(e)},error:function(){Galleria.raise('Init failed: Galleria could not find the element "'+i+'".')},timeout:5e3})}),this)}}(jQuery);var $window,$body,Site={init:function(){$body=$("body"),$window=$(window),Carousel.addTheme(),Carousel.init(),$window.on("throttledresize",Site.onResize)},onResize:function(){if(isMobile=$window.width()<980)$(".galleria").css({maxHeight:"auto"});else{var t=$window.height(),e=$(".galleria").length?t-$(".galleria").position().top-100:t;$(".galleria-container").css({maxHeight:e})}}},Carousel={init:function(){$(".galleria").length>0&&$(".galleria").galleria({debug:!1,autoplay:!0,responsive:!0,height:.55,imageCrop:"landscape",transition:"slide",thumbMargin:10,showCounter:!1,showInfo:!1,thumbnails:$(".galleria").children().length>1?"empty":!1})},addTheme:function(){Galleria.addTheme({name:"classic",author:"Galleria",css:"galleria.classic.css",defaults:{transition:"slide",thumbCrop:"height",_toggleInfo:!1},init:function(t){this.addElement("info-link","info-close"),this.append({info:["info-link","info-close"]});var e=this.$("info-link,info-close,info-text"),i=Galleria.TOUCH,a=i?"touchstart":"click";this.$("loader,counter").show().css("opacity",.4),i||(this.addIdleState(this.get("image-nav-left"),{left:-50}),this.addIdleState(this.get("image-nav-right"),{right:-50}),this.addIdleState(this.get("counter"),{opacity:0})),t._toggleInfo===!0?e.bind(a,function(){e.toggle()}):(e.show(),this.$("info-link, info-close").hide()),this.bind("thumbnail",function(t){i?$(t.thumbTarget).css("opacity",this.getIndex()?1:.6):($(t.thumbTarget).css("opacity",.6).parent().hover(function(){$(this).not(".active").children().stop().fadeTo(100,1)},function(){$(this).not(".active").children().stop().fadeTo(400,.6)}),t.index===this.getIndex()&&$(t.thumbTarget).css("opacity",1))}),this.bind("loadstart",function(t){t.cached||this.$("loader").show().fadeTo(200,.4),this.$("info").toggle(this.hasInfo()),$(t.thumbTarget).css("opacity",1).parent().siblings().children().css("opacity",.6)}),this.bind("loadfinish",function(){this.$("loader").fadeOut(200)})}})}};$(document).ready(function(){Site.init()});